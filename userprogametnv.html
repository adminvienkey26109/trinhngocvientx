<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>Nh·∫≠p key ƒë·ªÉ v√†o game</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 600px;
      margin: 30px auto;
      text-align: center;
      background: url('https://i.imgur.com/1JdFvXb.jpg') no-repeat center center fixed;
      background-size: cover;
      color: white;
    }
    input {
      padding: 10px;
      width: 80%;
      font-size: 16px;
      border-radius: 6px;
      border: none;
      margin-bottom: 10px;
    }
    button {
      padding: 10px 20px;
      font-size: 16px;
      margin: 5px;
      cursor: pointer;
      border-radius: 6px;
      border: 2px solid #1abc9c;
      background: transparent;
      color: #1abc9c;
      font-weight: bold;
      transition: all 0.3s ease;
      text-shadow: 0 0 5px #1abc9c;
    }
    button:hover {
      background-color: #1abc9c;
      color: #fff;
      text-shadow: none;
      box-shadow: 0 0 8px #16a085;
    }
    #status {
      margin-top: 20px;
      font-weight: bold;
      font-size: 18px;
      text-shadow: 0 0 5px #000;
    }
    #gameMenu {
      margin-top: 30px;
      display: none;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
    }
    .game-btn {
      border: 2px solid #1abc9c;
      color: #1abc9c;
      padding: 10px 15px;
      border-radius: 10px;
      font-weight: bold;
      width: 100px;
      box-shadow: 0 0 8px #16a085;
      cursor: pointer;
      transition: 0.3s;
      user-select: none;
      position: relative;
      overflow: hidden;
    }
    .game-btn::before {
      content: '';
      position: absolute;
      width: 150%;
      height: 150%;
      background: linear-gradient(45deg, transparent, #1abc9c, transparent);
      animation: ledEffect 3s linear infinite;
      top: -50%;
      left: -50%;
      opacity: 0.6;
      border-radius: 10px;
      pointer-events: none;
      z-index: 0;
    }
    .game-btn span {
      position: relative;
      z-index: 1;
      text-shadow: 0 0 10px #1abc9c;
    }
    @keyframes ledEffect {
      0% {
        transform: rotate(0deg) translateX(-100%);
      }
      100% {
        transform: rotate(360deg) translateX(100%);
      }
    }
    #logoutBtn {
      margin-top: 15px;
      display: none;
      background-color: #e74c3c;
      border-color: #c0392b;
      color: white;
      box-shadow: none;
      text-shadow: none;
    }
    #logoutBtn:hover {
      background-color: #c0392b;
    }
    #adminMenuBtn {
      position: fixed;
      top: 15px;
      left: 15px;
      background: #1abc9c;
      border: none;
      border-radius: 6px;
      padding: 8px 12px;
      cursor: pointer;
      font-weight: bold;
      color: white;
      box-shadow: 0 0 10px #16a085;
      z-index: 1000;
    }
    #adminContacts {
      position: fixed;
      top: 50px;
      left: 15px;
      background: rgba(26, 188, 156, 0.9);
      border-radius: 10px;
      padding: 10px;
      display: none;
      z-index: 999;
      width: 200px;
      text-align: left;
      box-shadow: 0 0 15px #16a085;
    }
    #adminContacts a {
      display: block;
      color: white;
      margin: 5px 0;
      font-weight: bold;
      text-decoration: none;
      text-shadow: 0 0 3px black;
    }
    #note {
      margin-top: 40px;
      font-size: 14px;
      background: rgba(0,0,0,0.5);
      padding: 15px;
      border-radius: 10px;
      line-height: 1.4;
      font-weight: bold;
      color: #f1c40f;
      text-shadow: 0 0 5px black;
      user-select: none;
    }
    .countdown {
      font-weight: bold;
      font-size: 20px;
      margin-top: 15px;
      color: #1abc9c;
      text-shadow: 0 0 10px #16a085;
      animation: pulse 2s infinite;
    }
    @keyframes pulse {
      0%, 100% { text-shadow: 0 0 10px #16a085; }
      50% { text-shadow: 0 0 20px #1abc9c; }
    }
  </style>
</head>
<body>

<button id="adminMenuBtn" onclick="toggleAdminContacts()">Menu Admin</button>
<div id="adminContacts">
  <a href="https://facebook.com/admin1" target="_blank">Admin 1</a>
  <a href="https://facebook.com/admin2" target="_blank">Admin 2</a>
  <a href="https://facebook.com/admin3" target="_blank">Admin 3</a>
</div>

<h2>üéÆ V√†o game b·∫±ng key</h2>
<p>Nh·∫≠p key ƒë·ªÉ k√≠ch ho·∫°t, ho·∫∑c b·∫°n ƒë√£ ƒëƒÉng nh·∫≠p r·ªìi.</p>
<input type="text" id="userKey" placeholder="Nh·∫≠p key b·∫°n c√≥..."><br>
<button onclick="checkKey()">‚úÖ Ki·ªÉm tra key</button>
<p id="status"></p>

<!-- Game Menu -->
<div id="gameMenu" style="display:none; flex-direction: column; align-items: center;">
  <h3>Ch·ªçn game b·∫°n mu·ªën ch∆°i:</h3>
  <div id="gamesButtons" style="display:flex; flex-wrap: wrap; justify-content:center; gap:10px;"></div>
  <p id="countdown" class="countdown"></p>
  <button id="logoutBtn" onclick="logout()">üö™ ƒêƒÉng xu·∫•t</button>
</div>

<!-- Note -->
<div id="note">
  ƒê√ÇY L√Ä TOOL ANH EM NH√Ä KV, KHUY·∫æN C√ÅO ANH EM ƒê·∫∂T C∆Ø·ª¢C √çT B·ªûI V√å TOOL KH√Å L·ªé N√äN ANH EM M·∫§T TI·ªÄN TH√å ƒê·ª™NG C√ì S·ª¶A ·∫≤NGGG !!!!!!!!
</div>

<script>
  // Link t·ªõi file keys.json tr√™n GitHub b·∫°n l∆∞u tr·ªØ key (c·∫ßn thay link th·∫≠t)
  const keysURL = "https://raw.githubusercontent.com/adminvienkey26109/trinhngocvientx/refs/heads/main/keys.json";

  // ƒê·ªïi t√™n file game t·∫°i ƒë√¢y
  const gameLinks = [
    "taixiu.html",        // Game 1
    "quayso.html",        // Game 2
    "baucua.html",        // Game 3
    "xocdia.html",        // Game 4
    "luckyspin.html",     // Game 5
    "slotmachine.html",   // Game 6
    "poker.html",         // Game 7
    "minigame1.html",     // Game 8
    "minigame2.html",     // Game 9
    "minigame3.html"      // Game 10
  ];

  const status = document.getElementById("status");
  const gameMenu = document.getElementById("gameMenu");
  const gamesButtons = document.getElementById("gamesButtons");
  const logoutBtn = document.getElementById("logoutBtn");
  const countdownElem = document.getElementById("countdown");
  const userKeyInput = document.getElementById("userKey");
  const checkBtn = document.querySelector("button[onclick='checkKey()']");

  // L∆∞u key ƒë√£ ƒëƒÉng nh·∫≠p localStorage ƒë·ªÉ l·∫ßn sau v√†o lu√¥n
  const STORAGE_KEY = "activeUserKey";
  const STORAGE_EXPIRE = "activeUserKeyExpire";

  // Hi·ªán/·∫©n menu admin
  function toggleAdminContacts() {
    const cont = document.getElementById("adminContacts");
    cont.style.display = cont.style.display === "block" ? "none" : "block";
  }

  // H√†m hi·ªÉn th·ªã menu game v·ªõi c√°c n√∫t b·∫•m v√† b·∫Øt ƒë·∫ßu ƒë·∫øm ng∆∞·ª£c n·∫øu c√≥ expire
  function showGameMenu(expireDate) {
    gameMenu.style.display = "flex";
    userKeyInput.style.display = "none";
    checkBtn.style.display = "none";
    logoutBtn.style.display = "inline-block";

    gamesButtons.innerHTML = "";
    for (let i = 0; i < gameLinks.length; i++) {
      const btn = document.createElement("button");
      btn.className = "game-btn";
      btn.innerHTML = `<span>Game ${i+1}</span>`;
      btn.onclick = () => {
        window.location.href = gameLinks[i];
      };
      gamesButtons.appendChild(btn);
    }

    if (expireDate) {
      startCountdown(new Date(expireDate));
    } else {
      countdownElem.textContent = "";
    }
  }

  let countdownInterval;
  function startCountdown(expireDate) {
    clearInterval(countdownInterval);

    function updateCountdown() {
      const now = new Date();
      const diff = expireDate - now;

      if (diff <= 0) {
        clearInterval(countdownInterval);
        alert("‚è∞ Key c·ªßa b·∫°n ƒë√£ h·∫øt h·∫°n v√† b·ªã ban!");
        logout();
        return;
      }

      const days = Math.floor(diff / (1000 * 60 * 60 * 24));
      const hours = Math.floor((diff / (1000 * 60 * 60)) % 24);
      const minutes = Math.floor((diff / (1000 * 60)) % 60);
      const seconds = Math.floor((diff / 1000) % 60);

      countdownElem.textContent = `‚è≥ Th·ªùi gian c√≤n l·∫°i: ${days} ng√†y ${hours} gi·ªù ${minutes} ph√∫t ${seconds} gi√¢y`;
    }

    updateCountdown();
    countdownInterval = setInterval(updateCountdown, 1000);
  }

  // H√†m ki·ªÉm tra key
  async function checkKey() {
    const key = userKeyInput.value.trim();
    if (!key) {
      status.textContent = "‚ö†Ô∏è Vui l√≤ng nh·∫≠p key.";
      return;
    }

    status.textContent = "‚è≥ ƒêang ki·ªÉm tra key...";

    try {
      const res = await fetch(keysURL);
      if (!res.ok) {
        status.textContent = "‚ùå Kh√¥ng th·ªÉ t·∫£i danh s√°ch key.";
        return;
      }
      const data = await res.json();

      // data gi·∫£ ƒë·ªãnh l√† m·∫£ng object d·∫°ng { key: "...", expiresAt: "2025-12-31T23:59:59Z" }
      const found = data.find(k => k.key === key);

      if (!found) {
        status.textContent = "‚ùå Key kh√¥ng h·ª£p l·ªá ho·∫∑c kh√¥ng t·ªìn t·∫°i.";
        return;
      }

      // Ki·ªÉm tra expire n·∫øu c√≥
      if (found.expiresAt) {
        const expireDate = new Date(found.expiresAt);
        if (expireDate < new Date()) {
          status.textContent = "‚è∞ Key ƒë√£ h·∫øt h·∫°n!";
          return;
        }
        // L∆∞u key v√† expire
        localStorage.setItem(STORAGE_KEY, key);
        localStorage.setItem(STORAGE_EXPIRE, found.expiresAt);
        status.textContent = "‚úÖ Key h·ª£p l·ªá! ƒêang v√†o menu game...";
        showGameMenu(found.expiresAt);
      } else {
        // L∆∞u key kh√¥ng expire
        localStorage.setItem(STORAGE_KEY, key);
        localStorage.removeItem(STORAGE_EXPIRE);
        status.textContent = "‚úÖ Key h·ª£p l·ªá! ƒêang v√†o menu game...";
        showGameMenu(null);
      }
    } catch (e) {
      status.textContent = "‚ùå L·ªói k·∫øt n·ªëi, vui l√≤ng th·ª≠ l·∫°i.";
    }
  }

  // H√†m logout: x√≥a key ƒë√£ l∆∞u, tr·∫£ v·ªÅ m√†n h√¨nh nh·∫≠p key
  function logout() {
    localStorage.removeItem(STORAGE_KEY);
    localStorage.removeItem(STORAGE_EXPIRE);
    gameMenu.style.display = "none";
    userKeyInput.style.display = "inline-block";
    checkBtn.style.display = "inline-block";
    logoutBtn.style.display = "none";
    status.textContent = "";
    countdownElem.textContent = "";
    userKeyInput.value = "";
  }

  // T·ª± ƒë·ªông check key n·∫øu ƒë√£ l∆∞u
  window.onload = () => {
    const storedKey = localStorage.getItem(STORAGE_KEY);
    const storedExpire = localStorage.getItem(STORAGE_EXPIRE);

    if (storedKey) {
      status.textContent = "‚è≥ ƒêang ki·ªÉm tra key ƒë√£ l∆∞u...";
      fetch(keysURL).then(res => res.json()).then(data => {
        const found = data.find(k => k.key === storedKey);
        if (found) {
          if (found.expiresAt) {
            const expireDate = new Date(found.expiresAt);
            if (expireDate < new Date()) {
              logout();
              status.textContent = "‚è∞ Key ƒë√£ h·∫øt h·∫°n, vui l√≤ng nh·∫≠p l·∫°i.";
            } else {
              status.textContent = "‚úÖ Key h·ª£p l·ªá! ƒêang v√†o menu game...";
              showGameMenu(found.expiresAt);
            }
          } else {
            status.textContent = "‚úÖ Key h·ª£p l·ªá! ƒêang v√†o menu game...";
            showGameMenu(null);
          }
        } else {
          logout();
          status.textContent = "‚ùå Key kh√¥ng h·ª£p l·ªá, vui l√≤ng nh·∫≠p l·∫°i.";
        }
      }).catch(() => {
        status.textContent = "‚ùå L·ªói t·∫£i d·ªØ li·ªáu key.";
      });
    }
  }
</script>

</body>
</html>
